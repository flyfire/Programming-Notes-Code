# 第十三章：MOP方法注入

java程序员常常抱怨：要是String支持encrypt方法就方便了。
面向对象本就是针对程序的可扩展性，但具体能扩展到什么程度往往要受到语言本身的限制。

而Groovy可以做到打开任意类，根据需要加入想要的方法。根据所接收到的特定输入添加一个方法，能够修改类的行为，是元编程
和Groovy元对象的核心。

Groovy的MOP支持以下三种技术行为中的任一种：
- 分类(category)
- ExpandoMetaClass
- Minxin

## 1 使用分类注入方法

Groovy的分类提供了一种可控的注入方式--方法的注入的作用可以限定在一个代码块内，分类是一种
能够修改类的metaClass对象，而且这种修改仅在代码块的作用域和执行线程内有效

示例`001CategoryMethodInject.groovy`


分类也有一些限制，起作用限定在use代码块内，所以也限定于执行线程，因此注入的方法也是有限制的，多次的进入和退出use也是
有代价的，因此如果调用不太频繁，而且需要分类提供的可控方法注入，则可以选择分类进行方法注入。

## 2 使用ExpandoMetaClass注入方法


要创建领域特定语言(DSL)，需要能够向不同的类、甚至类的层次结构中加入任意方法，为了保持一定的流畅性，
我们需要注入实例方法和静态方法，操纵构造器，以及将实例方法转换为属性。


示例`002ExpandoMetaClassMethodInject.groovy`

使用ExpandoMetaClass注入方法也有一些限制，注入的方法智能从Groovy内调用，不能从编译的java代码中调用。



## 3 使用Mixin注入方法

Groovy的Mixin(混入、混合)是一种运行时能力，可以将多个类的实现引入进来或者混入，如果将一个类混入另一个类，Groovy会在内存中把这些类的实例
连接起来，当调用一个实例的方法时，将会先路由到混入的类中，如果该方法存在混入的类中，则在混入的类中处理，否则由主类处理，可以将多个类
混入到一个类中，最后加入的Mixin优先级最高。

示例`003MixinInjectMethod.groovy、MixinInjectMultiMethod.groovy`









