# IO库

C++不直接处理输入输出，而是通过定义在标准库中的类型来处理IO。

## 1 IO类

为了支持不同的IO操作，标准库定义了一些IO类型，分别在3个独立的头文件中。

**头文件：iostream**
    - istream、wiostream 从流读取数据
    - ostream、wostream 从流写入数据
    - iostream、wiostream 读写流

前面用到的cin是istream是实现，而cout是ostream的实现。

**头文件：fstream**
    - ifstream、 wifstream 从文件读取数据
    - ofstream、 wofstream 向文件写入数据
    - fstream、wfstream 读写文件
   
**头文件：sstream**
    - istringstream、wistringstream 从string读取数据
    - ostringstream、wostringstream 向string写入数据
    - stringstream、wstringstream 读写string
    
以w开头的IO类型，用处理宽字符。


### IO类型之间的关系

通过**继承机制**，C++屏蔽了具体IO操作的细节，标准库是我们能够忽略不同类型的流之间的差异。

类型ifstream、istringstream都继承自istream类。

###  IO对象无拷贝和赋值

IO对象不能够被拷贝和赋值，这个要求有两层特别重要的含义：

- 只有支持复制的元素类型可以存储在 vector 或其他容器类型里。由于流对象不能复制，因此不能存储在 vector（或其他）容器中（即不存在存储流对象的 vector 或其他容器）。
- 不能将形参和返回类型设置为IO类型，通常以引用的方式传递和返回流，读写一个IO对象会改变其状态，因此传递和返回的流的引用不能使const的。

### IO条件状态

IO操作与生俱来的问题就是可能发生错误，一些错误可以修复，一些系统深处的错误却超出了应用程序的处理范围，下面列出的一些函数和标识可以帮助我们
访问和操纵流的条件状态:

 
状态	| 含义
--- | ---
strm::iostate		| strm是一种IO类型。iostate是一种机器相关的整型，提供了表达条件状态的完整功能
strm::badbit		| strm::badbit用来指出流已崩溃
strm::failbit		| strm::failbit用来指出一个IO操作失败了
strm::eofbit		| strm::eofbit用来指出流达到了文件结束
strm::goodbit		| strm::goodbit用来指出流未处于错误状态。此值保证为零
s.eof()		| 若流 s 的 eofbit 置位，则返回 true
s.fail()		| 若流 s 的 failbit 或 badbit 置位，则返回 true
s.bad()		| 若流 s 的 badbit 置位，则返回 true
s.good()		| 若流 s 处于有效状态，则返回 true
s.clear()		| 将流 s 中的所有条件状态位复位，将流的状态设置为有效。返回void
s.clear(flag)		| 根据给定的 flags 标志位，将流 s 中对于条件状态位复位。 flag 的类型是strm::iostate。返回 void
s.setstate(flag)		| 根据给定的 flags 标志位，将流 s 中对于条件状态位置位。 flag 的类型是strm::iostate。返回 void
s.rdstate()		| 返回流 s 的当前条件，返回值类型为 strm::iostate


参考下面代码：
```
int val
cin >> val
```
如果在标准输入流中输入字符串"BOO"，读操纵会失败，cin会进入错误状态，类似如果输入一个文件
结束标识，cin也会进入错误状态。**一旦一个流发生错误，其后续的操纵都会失败**，由于在操作
流时，流可能处于错误状态，所以代码应该在使用流之前检查流是否处于正常状态。比如：
```
while(cin >> word){
    //ok 操作时成功的
}
```

有时需要直到流发生了什么错误，IO定义的iostate是一种机器相关的整型，提供了表达条件状态的完整功能，
这个类型应该作为一个位集来使用，IO库定义了4个iostate类型的constexpr值标识特定的位模式。


四种条件状态：

状态	 | 含义	 | 数值	 | good()	 | eof()	 | bad()	 | fail()	 | rdstate()
---|---|---|---|---|---|---|---
ios::goodbit	 | 流状态完全正常	 | 0	 | 1	 | 0	 | 0	 | 0	 | goodbit
ios::eofbit | 	已达到文件结束	 | 2	 | 0	 | 1	 | 0	 | 0	 | eofbit
ios::badbit	 | 输入（输出）流出现非致命错误，可挽回	 | 1	 | 0	 | 0	 | 1	 | 0	 | badbit
ios::failbit	 | 输入（输出）流出现致命错误，不可挽回	 | 4	 | 0	 | 0	 | 0	 | 1	 | failbit

goodbit为0表示流未发生错误，如果badbit、failbit、 eofbit任一个被置位，则检查流状态的条件都会失败。


### 管理条件状态


### 管理输出缓冲

